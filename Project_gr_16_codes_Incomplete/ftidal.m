function f=ftidal(x1,x2,x3,M,r)
f=(M/(2*r.^3))*(-2*x1*x1+x2*x2+x3*x3)-(M/(2*r.^4))*x1*(-2*x1*x1+3*(x2*x2+...
    x3*x3))-(M/(8*r.^5))*(8*x1.^4+3*x2.^4+3*x3.^4-24*(x1.^2*x2.^2+...
    x1*x1*x3*x3)+6*x2*x2*x3*x3)
end
